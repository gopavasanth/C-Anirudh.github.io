<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="prefer-datetime-locale" content="en-in"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="TJCTF - Circus challenge writeup" /><meta property="og:locale" content="en" /><meta name="description" content="Hello. I’m Chidambaranathan Anirudh. I am an Associate Software Engineer in Oracle, India." /><meta property="og:description" content="Hello. I’m Chidambaranathan Anirudh. I am an Associate Software Engineer in Oracle, India." /><link rel="canonical" href="https://c-anirudh.github.io/C-Anirudh.github.io/posts/tjctf-circus-writeup/" /><meta property="og:url" content="https://c-anirudh.github.io/C-Anirudh.github.io/posts/tjctf-circus-writeup/" /><meta property="og:site_name" content="Chidambaranathan Anirudh" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-05-27T17:30:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="TJCTF - Circus challenge writeup" /><meta name="twitter:site" content="@c_anirudh16" /><meta name="google-site-verification" content="MvB5B93DrVK-3EKC9fBVJKfWOvV_xuirE2Dcbw0qdKE" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-05-27T17:30:00+05:30","datePublished":"2020-05-27T17:30:00+05:30","description":"Hello. I’m Chidambaranathan Anirudh. I am an Associate Software Engineer in Oracle, India.","headline":"TJCTF - Circus challenge writeup","mainEntityOfPage":{"@type":"WebPage","@id":"https://c-anirudh.github.io/C-Anirudh.github.io/posts/tjctf-circus-writeup/"},"url":"https://c-anirudh.github.io/C-Anirudh.github.io/posts/tjctf-circus-writeup/"}</script><title>TJCTF - Circus challenge writeup | Chidambaranathan Anirudh</title><link rel="apple-touch-icon" sizes="180x180" href="/C-Anirudh.github.io/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/C-Anirudh.github.io/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/C-Anirudh.github.io/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/C-Anirudh.github.io/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/C-Anirudh.github.io/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Chidambaranathan Anirudh"><meta name="application-name" content="Chidambaranathan Anirudh"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/C-Anirudh.github.io/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/C-Anirudh.github.io/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/C-Anirudh.github.io/" alt="avatar" class="mx-auto"> <img src=" /C-Anirudh.github.io/assets/img/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/C-Anirudh.github.io/">Chidambaranathan Anirudh</a></div><div class="site-subtitle font-italic">ASE @Oracle | CS Grad</div></div><ul class="w-100"><li class="nav-item"> <a href="/C-Anirudh.github.io/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/C-Anirudh.github.io/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/C-Anirudh.github.io/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/C-Anirudh.github.io/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/C-Anirudh.github.io/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/C-Anirudh" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/c_anirudh16" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['caniruhd16','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/c-anirudh" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://stackoverflow.com/users/10132227/c-anirudh?tab=profile" aria-label="stack-overflow" target="_blank" rel="noopener"> <i class="fab fa-stack-overflow"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/C-Anirudh.github.io/"> Home </a> </span> <span>TJCTF - Circus challenge writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>TJCTF - Circus challenge writeup</h1><div class="post-meta text-muted"><div> By <em> <a href="https://www.linkedin.com/in/c-anirudh">Chidambaranathan Anirudh</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1590580800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2020-05-27 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="732 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="/C-Anirudh.github.io/assets/img/posts/tjctf-gamerw-writeup/TJCTF.png" alt="TJCTF 2020" title="TJCTF2020" data-proofer-ignore></p><p>This is a writeup for the <code class="language-plaintext highlighter-rouge">Circus</code> challenge in the recently held <a href="https://tjctf.org/">TJCTF 2020</a>.</p><p><img data-src="/C-Anirudh.github.io/assets/img/posts/tjctf-circus-writeup/chall-circus.png" alt="Challenge" title="Circus" data-proofer-ignore></p><p>After staring at the website for some time and going through its source code, I didn’t find anything of significance. So I decided to use the <a href="https://github.com/maurosoria/dirsearch"><code class="language-plaintext highlighter-rouge">dirsearch</code></a> command line tool to look for files and directories in the website.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python dirsearch.py <span class="nt">-b</span> <span class="nt">-u</span> https://circus.tjctf.org/ <span class="nt">-e</span> <span class="k">*</span>
</pre></table></code></div></div><p>The tool gave me some interesting results -</p><p><img data-src="/C-Anirudh.github.io/assets/img/posts/tjctf-circus-writeup/dirsearch-result.png" alt="dirseach result" title="dirsearch results" data-proofer-ignore></p><p>As you can see from the image, the website had hosted its version control repository (<code class="language-plaintext highlighter-rouge">.git/</code>) in production. This is bad and can be used to gain access to the website’s source code.</p><p>Please refer this <a href="https://en.internetwache.org/dont-publicly-expose-git-or-how-we-downloaded-your-websites-sourcecode-an-analysis-of-alexas-1m-28-07-2015/">post</a> for more detailed information on this.</p><p>Heading to <code class="language-plaintext highlighter-rouge">https://circus.tjctf.org/.git/refs/heads/master</code> gave us the commit hash <code class="language-plaintext highlighter-rouge">4879af041fba89b387e751a94bfe5dbee4bd7528</code>.</p><p>We use this to download the commit-object from the server by going to <code class="language-plaintext highlighter-rouge">https://circus.tjctf.org/.git/objects/48/79af041fba89b387e751a94bfe5dbee4bd7528</code></p><p>I then created a local git repository and pasted the commit-object file in the <code class="language-plaintext highlighter-rouge">.git/objects/48</code> folder.</p><blockquote><p><strong>Note</strong>: Here 48 is the first 2 bytes of the commit hash</p></blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">mkdir </span>cirucs
<span class="nv">$ </span><span class="nb">cd </span>circus/
<span class="nv">$ </span>git init
<span class="nv">$ </span><span class="nb">mkdir</span> .git/objects/48/
<span class="nv">$ </span><span class="nb">cp</span> ~/Downloads/79af041fba89b387e751a94bfe5dbee4bd7528 ~/Downloads/circus/.git/objects/48/
</pre></table></code></div></div><p>Now we can analyse it further:</p><p>This tells us that the downloaded object is a commit:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>git cat-file <span class="nt">-t</span> 4879af041fba89b387e751a94bfe5dbee4bd7528
commit
</pre></table></code></div></div><p>Getting further details:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>git cat-file <span class="nt">-p</span> 4879af041fba89b387e751a94bfe5dbee4bd7528
tree 2f16dc45649e2748d2345f01b076fb6efae38f47
parent e2731f0ea54feb0a892fd5377a932053bb3baf61
author kfb &lt;kfb@circus.tjctf.org&gt; 1584979440 <span class="nt">-0700</span>
committer kfb &lt;kfb@circus.tjctf.org&gt; 1584979440 <span class="nt">-0700</span>

oops
</pre></table></code></div></div><p>We next download the tree object and analyse it in the same way. Go to <code class="language-plaintext highlighter-rouge">https://circus.tjctf.org/.git/objects/2f/16dc45649e2748d2345f01b076fb6efae38f47</code> to download the object and paste it in the <code class="language-plaintext highlighter-rouge">circus/.git/objects/2f/</code> folder.</p><p>Analysing the tree object:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$ </span>git cat-file <span class="nt">-p</span> 2f16dc45649e2748d2345f01b076fb6efae38f47
100644 blob 0c2dcae6b4a2df8b0e36f9764c82e67f63b6ffa5	.gitignore
040000 tree efb43702c73bf9b9ed4bdc67ab139e8431fff12e	css
040000 tree af6d89e6ba71c3d121bb931e11d2d0ca52f4bcb3	img
100644 blob ad9052a7a90a878dcbb120089eb96739149511ac	index.php
040000 tree 4604bf31e608e07a063c11888dc3092cf77ccfff	js
040000 tree 8a0a57c3988c44b23e079e4cccf603bc58d911b8	lib
100644 blob ef808b5889ece41f90c38567d53b7e8e13c0a489	logout.php
</pre></table></code></div></div><p>We now download the <code class="language-plaintext highlighter-rouge">index.php</code> blob (follow the same step as above) and cat its contents.</p><p>We extract the following PHP code from the file:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span> 
	<span class="k">require</span> <span class="k">__DIR__</span> <span class="mf">.</span> <span class="s2">"/../include/flag.php"</span><span class="p">;</span>

	<span class="nb">session_start</span><span class="p">();</span>
	<span class="nv">$error</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
	<span class="nb">mysqli_report</span><span class="p">(</span><span class="no">MYSQLI_REPORT_ERROR</span> <span class="o">|</span> <span class="no">MYSQLI_REPORT_STRICT</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"username"</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"password"</span><span class="p">]))</span>
	<span class="p">{</span>
		<span class="k">try</span>
		<span class="p">{</span>
			<span class="nv">$mysqli</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">mysqli</span><span class="p">(</span><span class="kc">NULL</span><span class="p">,</span> <span class="kc">NULL</span><span class="p">,</span> <span class="kc">NULL</span><span class="p">,</span> <span class="s2">"circus"</span><span class="p">);</span>
			<span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$mysqli</span><span class="o">-&gt;</span><span class="nf">prepare</span><span class="p">(</span><span class="s2">"SELECT * FROM users WHERE username = ?"</span><span class="p">);</span>
			<span class="nv">$stmt</span><span class="o">-&gt;</span><span class="nf">bind_param</span><span class="p">(</span><span class="s2">"s"</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]);</span>
			<span class="nv">$stmt</span><span class="o">-&gt;</span><span class="nf">execute</span><span class="p">();</span>
			<span class="nv">$res</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="nf">get_result</span><span class="p">();</span>
			<span class="k">if</span> <span class="p">(</span><span class="nv">$res</span><span class="o">-&gt;</span><span class="n">num_rows</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="nv">$error</span> <span class="o">=</span> <span class="s2">"Invalid credentials"</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">else</span>
			<span class="p">{</span>
				<span class="nv">$row</span> <span class="o">=</span> <span class="nv">$res</span><span class="o">-&gt;</span><span class="nf">fetch_assoc</span><span class="p">();</span>
				<span class="k">if</span> <span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="s1">'sha256'</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">"password"</span><span class="p">])</span> <span class="o">==</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">"password"</span><span class="p">])</span>
				<span class="p">{</span>
					<span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">"id"</span><span class="p">];</span>
					<span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">"fname"</span><span class="p">];</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">catch</span> <span class="p">(</span><span class="nc">Exception</span> <span class="nv">$e</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="nv">$error</span> <span class="o">=</span> <span class="s2">"Error signing in"</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>From <code class="language-plaintext highlighter-rouge">https://circus.tjctf.org/.git/logs/refs/heads/master</code> we can see that the commit hash we analysed was the second commit. The commit message “oops” also hints that the developer might have pushed some sensitive content in his first commit which he corrected in the second commit. But the sensitive content will still be stored in the git version history.</p><p>Read this <a href="https://www.honeybadger.io/blog/git-security/">blog post</a> for more.</p><p>We saw that the second commit contained a new <code class="language-plaintext highlighter-rouge">.gitignore</code> file. So lets print the contents of that.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>git cat-file <span class="nt">-p</span> 0c2dcae6b4a2df8b0e36f9764c82e67f63b6ffa5
backup.sh
backups
</pre></table></code></div></div><p>We can see that the developer must have committed the <code class="language-plaintext highlighter-rouge">backup.sh</code> file before (1st commit) which he has now put in the <code class="language-plaintext highlighter-rouge">.gitnore</code> file now.</p><p>Going to <code class="language-plaintext highlighter-rouge">https://circus.tjctf.org/backup.sh</code> , we are pointed to <code class="language-plaintext highlighter-rouge">https://circus.tjctf.org/backups/users.sql</code> which gives us the backup of the database containing usernames and their password hashes.</p><p>The password verification logic in the PHP code uses the “==” operator and we have the SHA-256 password hashes of the users, so it was safe to assume that the website may be susceptible to <code class="language-plaintext highlighter-rouge">Type Juggling attack through magic hash comparison</code>.</p><p>Refer this <a href="https://www.whitehatsec.com/blog/magic-hashes/">blog post</a> for more about magic hashes.</p><p>I searched the SQL file for a password hash which fit the magic hash format of <code class="language-plaintext highlighter-rouge">0+e[0-9]+</code> and was able to find a user who fit the bill:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(773,'Andon1956','0e75759761935916943951971647195794671357976597614357959761597165','Rosie','Kelly')
</pre></table></code></div></div><p>All that I had to do now, was use the username <code class="language-plaintext highlighter-rouge">Andon1956</code> along with a matching SHA-256 magic hash.</p><p><a href="https://github.com/spaze/hashes/blob/master/sha256.md">This</a> GitHub repository holds a list of SHA-256 magic hashes.</p><p>The flag was displayed on screen after logging in.</p><p><img data-src="/C-Anirudh.github.io/assets/img/posts/tjctf-circus-writeup/chall-flag.png" alt="Challenge Flag" title="Circus Flag" data-proofer-ignore></p><p>I would like to thank <a href="https://www.linkedin.com/in/nimisha-dughyala/">Nimisha Dughyala</a> for guiding me in solving this challenge. It wouldn’t have been possible without her :)</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/C-Anirudh.github.io/categories/technical/'>Technical</a>, <a href='/C-Anirudh.github.io/categories/ctf-writeups/'>CTF-writeups</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/C-Anirudh.github.io/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/C-Anirudh.github.io/tags/writeups/" class="post-tag no-text-decoration" >writeups</a> <a href="/C-Anirudh.github.io/tags/git-security/" class="post-tag no-text-decoration" >git-security</a> <a href="/C-Anirudh.github.io/tags/php-type-juggling/" class="post-tag no-text-decoration" >php-type-juggling</a> <a href="/C-Anirudh.github.io/tags/magic-hashes/" class="post-tag no-text-decoration" >magic-hashes</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=TJCTF - Circus challenge writeup - Chidambaranathan Anirudh&amp;url=https://c-anirudh.github.io/C-Anirudh.github.io/posts/tjctf-circus-writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=TJCTF - Circus challenge writeup - Chidambaranathan Anirudh&amp;u=https://c-anirudh.github.io/C-Anirudh.github.io/posts/tjctf-circus-writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://c-anirudh.github.io/C-Anirudh.github.io/posts/tjctf-circus-writeup/&amp;text=TJCTF - Circus challenge writeup - Chidambaranathan Anirudh" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://c-anirudh.github.io/C-Anirudh.github.io/posts/tjctf-circus-writeup/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/C-Anirudh.github.io/tags/notes/">notes</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/ctf/">ctf</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/writeups/">writeups</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/aptitude/">aptitude</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/calendar/">calendar</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/cetus-extension/">cetus-extension</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/email-security/">email-security</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/experience/">experience</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/git-security/">git-security</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/go/">go</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/C-Anirudh.github.io/posts/tjctf-gamerw-writeup/"><div class="card-body"> <em class="timeago small" data-ts="1590559860" > 2020-05-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TJCTF - Gamer W challenge writeup</h3><div class="text-muted small"><p> This is a writeup for the Gamer W challenge in the recently held TJCTF 2020. The challenge required us to cheat in a web assembly game using the Cetus browser extension. I cloned the extens...</p></div></div></a></div><div class="card"> <a href="/C-Anirudh.github.io/posts/first-go-program/"><div class="card-body"> <em class="timeago small" data-ts="1562593320" > 2019-07-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>First Go program</h3><div class="text-muted small"><p> Every Go source file belongs to a package. A package is nothing but a collection of files. Here by defining the package as main, we are telling the Go compiler to compile the package as an executab...</p></div></div></a></div><div class="card"> <a href="/C-Anirudh.github.io/posts/how-to-prepare-for-campus-placements/"><div class="card-body"> <em class="timeago small" data-ts="1626427800" > 2021-07-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to prepare for Campus Placements?</h3><div class="text-muted small"><p> This is written from my experience of appearing for campus placements. The blog post is a general guide and NOT written considering a specific company. The resources and the prepa...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/C-Anirudh.github.io/posts/tjctf-gamerw-writeup/" class="btn btn-outline-primary" prompt="Older"><p>TJCTF - Gamer W challenge writeup</p></a> <a href="/C-Anirudh.github.io/posts/notes-pretty-good-privacy/" class="btn btn-outline-primary" prompt="Newer"><p>Notes - Pretty Good Privacy (PGP)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://www.linkedin.com/in/c-anirudh">Chidambaranathan Anirudh</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/C-Anirudh.github.io/tags/notes/">notes</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/ctf/">ctf</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/writeups/">writeups</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/aptitude/">aptitude</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/calendar/">calendar</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/cetus-extension/">cetus-extension</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/email-security/">email-security</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/experience/">experience</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/git-security/">git-security</a> <a class="post-tag" href="/C-Anirudh.github.io/tags/go/">go</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/C-Anirudh.github.io/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en-in.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/C-Anirudh.github.io/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/C-Anirudh.github.io/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-167413140-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-167413140-1'); }); </script>
